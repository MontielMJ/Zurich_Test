<div class="container">
  <div class="form-container">
    <mat-card>
      <mat-card-header>
        <mat-card-title>
          <mat-icon>edit</mat-icon>
          Editar Cliente
        </mat-card-title>
        <mat-card-subtitle>Modifique la información del cliente</mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <!-- Loading mientras carga el cliente -->
        <div *ngIf="isloadingCliente" class="loading-container">
          <mat-spinner diameter="50"></mat-spinner>
          <p>Cargando información del cliente...</p>
        </div>

        <!-- Formulario cuando ya cargó el cliente -->
        <form *ngIf="!isloadingCliente" [formGroup]="clienteForm" (ngSubmit)="onSubmit()" class="cliente-form">
          
          <!-- Nombre Completo -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Nombre Completo</mat-label>
            <input 
              matInput 
              formControlName="fullname" 
              placeholder="Ingrese el nombre completo"
              maxlength="100">
            <mat-icon matSuffix>person</mat-icon>
            
            <mat-error *ngIf="fullname?.hasError('required')">
              El nombre completo es requerido
            </mat-error>
            <mat-error *ngIf="fullname?.hasError('minlength')">
              El nombre debe tener al menos 3 caracteres
            </mat-error>
            <mat-error *ngIf="fullname?.hasError('maxlength')">
              El nombre no puede exceder 100 caracteres
            </mat-error>
          </mat-form-field>

          <!-- Email -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Email</mat-label>
            <input 
              matInput 
              formControlName="email" 
              placeholder="Ingrese el email"
              type="email">
            <mat-icon matSuffix>email</mat-icon>
            
            <mat-error *ngIf="email?.hasError('required')">
              El email es requerido
            </mat-error>
            <mat-error *ngIf="email?.hasError('email')">
              Ingrese un email válido
            </mat-error>
          </mat-form-field>

          <!-- Teléfono -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Teléfono</mat-label>
            <input 
              matInput 
              formControlName="phone" 
              placeholder="Ingrese el teléfono"
              maxlength="10">
            <mat-icon matSuffix>phone</mat-icon>
            
            <mat-error *ngIf="phone?.hasError('required')">
              El teléfono es requerido
            </mat-error>
            <mat-error *ngIf="phone?.hasError('pattern')">
              Ingrese un número de teléfono válido (10-15 dígitos)
            </mat-error>
          </mat-form-field>

          <!-- Número de Identificación -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Número de Identificación</mat-label>
            <input 
              matInput 
              formControlName="identificationNumber" 
              placeholder="Ingrese el número de identificación"
              maxlength="10">
            <mat-icon matSuffix>badge</mat-icon>
            
            <mat-error *ngIf="identificationNumber?.hasError('required')">
              El número de identificación es requerido
            </mat-error>
            <mat-error *ngIf="identificationNumber?.hasError('pattern')">
              Ingrese un número de identificación válido (10-13 dígitos)
            </mat-error>
          </mat-form-field>

          <!-- Estado -->
          <mat-checkbox formControlName="status" class="full-width">
            Cliente Activo
          </mat-checkbox>
          <small class="hint">Si está desactivado, el cliente no podrá ser asociado a nuevas pólizas</small>

        </form>
      </mat-card-content>

      <mat-card-actions *ngIf="!isloadingCliente" align="end">
        <button 
          mat-button 
          type="button" 
          (click)="onCancel()"
          class="cancel-button"
          [disabled]="isLoading">
          <mat-icon>cancel</mat-icon>
          Cancelar
        </button>
        
        <button 
          mat-raised-button 
          color="primary" 
          type="submit"
          (click)="onSubmit()"
          [disabled]="isLoading || clienteForm.invalid || clienteForm.pristine"
          class="submit-button">
          <mat-icon *ngIf="!isLoading">save</mat-icon>
          <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
          {{ isLoading ? 'Actualizando...' : 'Actualizar Cliente' }}
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>